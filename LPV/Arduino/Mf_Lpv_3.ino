#include <MatrixMath.h>
#include <avr/pgmspace.h> //alocar espaço memória FLASH

const int ledPin = 9;
const int solarPin = A2;


const float ref[2901] PROGMEM = {0,0.0204081632653061,0.0408163265306122,0.0612244897959184,0.0816326530612245,0.102040816326531,0.122448979591837,0.142857142857143,0.163265306122449,0.183673469387755,0.204081632653061,0.224489795918367,0.244897959183673,0.26530612244898,0.285714285714286,0.306122448979592,0.326530612244898,0.346938775510204,0.36734693877551,0.387755102040816,0.408163265306122,0.428571428571429,0.448979591836735,0.469387755102041,0.489795918367347,0.510204081632653,0.530612244897959,0.551020408163265,0.571428571428571,0.591836734693878,0.612244897959184,0.63265306122449,0.653061224489796,0.673469387755102,0.693877551020408,0.714285714285714,0.73469387755102,0.755102040816326,0.775510204081633,0.795918367346939,0.816326530612245,0.836734693877551,0.857142857142857,0.877551020408163,0.897959183673469,0.918367346938776,0.938775510204082,0.959183673469388,0.979591836734694,1,0.973696858192896,1.00007232197765,1.02599878710521,1.05147925557616,1.07651672939105,1.10111421055047,1.12527470105497,1.14900120290513,1.17229671810152,1.1951642486447,1.21760679653525,1.23962736377374,1.26122895236072,1.28241456429678,1.30318720158249,1.3235498662184,1.34350556020509,1.36305728554314,1.3822080442331,1.40096083827554,1.41931866967105,1.43728454042018,1.45486145252351,1.4720524079816,1.48886040879502,1.50528845696435,1.52133955449015,1.53701670337299,1.55232290561344,1.56726116321206,1.58183447816944,1.59604585248614,1.60989828816272,1.62339478719975,1.63653835159781,1.64933198335747,1.66177868447929,1.67388145696384,1.68564330281169,1.69706722402342,1.70815622259958,1.71891330054075,1.7293414598475,1.7394437025204,1.74922303056001,1.75868244596691,1.76782495074166,1.77665354688484,1.78517123639701,1.79338102127875,1.80128590353061,1.80888888515318,1.81619296814701,1.82320115451269,1.82991644625077,1.83634184536182,1.84248035384643,1.84833497370515,1.85390870693855,1.85920455554721,1.86422552153169,1.86897460689257,1.8734548136304,1.87766914374577,1.88162059923923,1.88531218211136,1.88874689436274,1.89192773799391,1.89485771500547,1.89753982739797,1.89997707717198,1.90217246632808,1.90412899686682,1.9058496707888,1.90733749009456,1.90859545678468,1.90962657285973,1.91043384032028,1.9110202611669,1.91138883740016,1.91154257102062,1.91148446402885,1.91121751842543,1.91074473621092,1.9100691193859,1.90919366995093,1.90812138990657,1.90685528125341,1.90539834599201,1.90375358612294,1.90192400364676,1.89991260056405,1.89772237887537,1.8953563405813,1.89281748768241,1.89010882217925,1.88723334607241,1.88419406136245,1.88099397004995,1.87763607413546,1.87412337561956,1.87045887650282,1.8666455787858,1.86268648446908,1.85858459555323,1.85434291403881,1.8499644419264,1.84545218121656,1.84080913390986,1.83603830200687,1.83114268750817,1.82612529241431,1.82098911872587,1.81573716844342,1.81037244356753,1.80489794609876,1.79931667803769,1.79363164138488,1.7878458381409,1.78196227030633,1.77598393988173,1.76991384886768,1.76375499926473,1.75751039307346,1.75118303229444,1.74477591892824,1.73829205497543,1.73173444243657,1.72510608331223,1.71840997960299,1.71164913330942,1.70482654643207,1.69794522097153,1.69100815892836,1.68401836230313,1.67697883309641,1.66989257330877,1.66276258494077,1.65559186999299,1.648383430466,1.64114026836036,1.63386538567665,1.62656178441543,1.61923246657727,1.61188043416275,1.60450868917242,1.59712023360687,1.58971806946665,1.58230519875234,1.57488462346451,1.56745934560373,1.56003236717056,1.55260669016558,1.54518531658935,1.53777124844244,1.53036748772543,1.52297703643887,1.51560289658335,1.50824807015943,1.50091555916768,1.49360836560866,1.48632949148295,1.47908193879112,1.47186870953374,1.46469280571136,1.45755722932458,1.45046498237394,1.44341906686003,1.43642248478341,1.42947823814465,1.42258932894432,1.41575875918298,1.40898953086122,1.40228464597959,1.39564710653867,1.38907991453902,1.38258607198122,1.37616858086583,1.36983044319343,1.36357466096457,1.35740423617984,1.3513221708398,1.34533146694502,1.33943512649606,1.33363615149351,1.32793754393792,1.32234230582986,1.31685343916992,1.31147394595864,1.30620682819661,1.30105508788439,1.29602172702256,1.29110974761167,1.28632215165231,1.28166194114503,1.27713211809041,1.27273568448902,1.26847564234143,1.2643549936482,1.26037674040991,1.25654388462712,1.25285942830041,1.24932637343033,1.24594772201747,1.24272647606239,1.23966563756566,1.23676820852785,1.23403719094953,1.23147558683126,1.22908639817362,1.22687262697718,1.22483727472679,1.22298221195016,1.22130578015552,1.21980563443797,1.21847942989262,1.21732482161457,1.21633946469894,1.21552101424082,1.21486712533532,1.21437545307756,1.21404365256264,1.21386937888566,1.21385028714173,1.21398403242595,1.21426826983344,1.2147006544593,1.21527884139864,1.21600048574656,1.21686324259817,1.21786476704858,1.21900271419288,1.2202747391262,1.22167849694364,1.22321164274029,1.22487183161128,1.2266567186517,1.22856395895666,1.23059120762127,1.23273611974063,1.23499635040986,1.23736955472405,1.23985338777832,1.24244550466777,1.2451435604875,1.24794521033264,1.25084810929827,1.2538499124795,1.25694827497146,1.26014085186923,1.26342529826793,1.26679926926266,1.27026041994853,1.27380640542065,1.27743488077412,1.28114350110405,1.28492992150554,1.28879179707371,1.29272678290365,1.29673253409049,1.30080670572931,1.30494695291523,1.30915093074336,1.31341629430879,1.31774069870665,1.32212179903203,1.32655725038004,1.33104470784579,1.33558182652438,1.34016626151093,1.34479566790053,1.34946770078829,1.35418001526932,1.35893026643873,1.36371610939163,1.36853519922311,1.37338519102829,1.37826373990227,1.38316850094016,1.38809712923707,1.3930472798881,1.39801660798836,1.40300276863295,1.40800341691699,1.41301620793557,1.41803879678381,1.42306883855681,1.42810398834968,1.43314190125752,1.43818023237544,1.44321663679855,1.44824876962196,1.45327428594076,1.45829084085008,1.463296089445,1.46828768682065,1.47326328807212,1.47822054829453,1.48315712258297,1.48807066603257,1.49295883373841,1.49781928079561,1.50264966229928,1.50744763334453,1.51221084902645,1.51693696444015,1.52162363468075,1.52626851484335,1.53086926002305,1.53542352531496,1.53992896581419,1.54438323661585,1.54878399281503,1.55312888950686,1.55741558178642,1.56164172474884,1.56580497348922,1.56990298310266,1.57393340868427,1.57789390532915,1.58178212813242,1.58559573218918,1.58933237259453,1.59298970444359,1.59656538283146,1.60005706285324,1.60346239960405,1.60677904817898,1.61000466367315,1.61313690118166,1.61617341579962,1.61911186374309,1.62195071392422,1.62469068053821,1.62733286226958,1.62987835780287,1.63232826582259,1.63468368501326,1.63694571405942,1.63911545164558,1.64119399645628,1.64318244717602,1.64508190248934,1.64689346108076,1.64861822163481,1.650257282836,1.65181174336886,1.65328270191792,1.6546712571677,1.65597850780273,1.65720555250752,1.6583534899666,1.65942341886449,1.66041643788572,1.66133364571482,1.6621761410363,1.66294502253469,1.66364138889451,1.66426633880029,1.66482097093655,1.66530638398782,1.66572367663861,1.66607394757346,1.66635829547688,1.6665778190334,1.66673361692755,1.66682678784384,1.66685843046681,1.66682964348097,1.66674152557084,1.66659517542097,1.66639169171585,1.66613217314003,1.66581771837802,1.66544942611435,1.66502839503354,1.66455572382012,1.66403251115861,1.66345985573352,1.6628388562294,1.66217061133075,1.66145621972211,1.660696780088,1.65989339111294,1.65904715148146,1.65815915987807,1.65723051498731,1.6562623154937,1.65525566008175,1.654211647436,1.65313137624097,1.65201594518118,1.65086645294116,1.64968399820543,1.64846967965851,1.64722459598492,1.6459498458692,1.64464652799587,1.64331574104944,1.64195858371444,1.6405761546754,1.63916955261685,1.63773987622329,1.63628822417926,1.63481569516929,1.63332338787789,1.63181240098959,1.63028383318891,1.62873878316037,1.62717834958851,1.62560363115784,1.62401572655289,1.62241573445819,1.62080475355824,1.61918388253759,1.61755422008075,1.61591686487225,1.61427291559661,1.61262347093835,1.610969629582,1.60931249021208,1.60765315151312,1.60599271216964,1.60433227086616,1.60267292628721,1.60101577711731,1.59936192204098,1.59771245974275,1.59606848890715,1.59443110821869,1.5928014163619,1.5911805120213,1.58956949388143,1.58796946062679,1.58638151094192,1.58480674351134,1.58324625701957,1.58170115015114,1.58017252159056,1.57866147002237,1.57716909413109,1.57569649260124,1.57424476411735,1.57281500736394,1.57140832102552,1.57002580378664,1.56866855433181,1.56733767134555,1.56603425351238,1.56475939951684,1.56351420804345,1.56229977670506,1.56111683982141,1.55996524116175,1.55884469053773,1.55775489776095,1.55669557264305,1.55566642499566,1.5546671646304,1.55369750135889,1.55275714499276,1.55184580534363,1.55096319222313,1.55010901544289,1.54928298481453,1.54848481014968,1.54771420125996,1.54697086795699,1.5462545200524,1.54556486735783,1.54490161968488,1.54426448684519,1.54365317865039,1.54306740491209,1.54250687544193,1.54197130005153,1.54146038855251,1.5409738507565,1.54051139647513,1.54007273552001,1.53965757770279,1.53926563283507,1.53889661072849,1.53855022119467,1.53822617404524,1.53792417909182,1.53764394614603,1.53738518501951,1.53714760552388,1.53693091747076,1.53673483067178,1.53655905493856,1.53640330008274,1.53626727591593,1.53615069224975,1.53605325889585,1.53597468566583,1.53591468237133,1.53587295882397,1.53584922483538,1.53584319021717,1.53585456478099,1.53588305833845,1.53592838070117,1.53599024168079,1.53606835108893,1.53616241873721,1.53627215443726,1.53639726800071,1.53653746923917,1.53669246796428,1.53686197398766,1.53704569712093,1.53724334717573,1.53745463396367,1.53767926729638,1.53791695698549,1.53816741284262,1.5384303446794,1.53870546230745,1.5389924755384,1.53929109418387,1.5396010280555,1.53992198696489,1.54025368072369,1.5405958191435,1.54094811203597,1.54131026921272,1.54168200048536,1.54206301566553,1.54245302456485,1.54285173699495,1.54325886276745,1.54367411169398,1.54409719358616,1.54452781825561,1.54496569551397,1.54541053517286,1.5458620470439,1.54631994093872,1.54678392666895,1.5472537140462,1.54772901288211,1.5482095329883,1.54869498417639,1.54918507625802,1.5496795190448,1.55017802234836,1.55068029598033,1.55118604975233,1.55169499347599,1.55220683696293,1.55272129002478,1.55323806247316,1.5537568641197,1.55427740477603,1.55479939425376,1.55532254236453,1.55584655891996,1.55637115373167,1.5568960366113,1.55742091737045,1.55794550582077,1.55846951177388,1.5589926450414,1.55951461543495,1.56003513276617,1.56055390684668,1.56107064748809,1.56158506450205,1.56209686770017,1.56260576683564,1.56311146049398,1.56361362291843,1.56411192514579,1.56460603821285,1.56509563315639,1.56558038101321,1.56605995282011,1.56653401961386,1.56700225243127,1.56746432230913,1.56791990028422,1.56836865739333,1.56881026467327,1.56924439316081,1.56967071389275,1.57008889790589,1.57049861623701,1.5708995399229,1.57129134000036,1.57167368750617,1.57204625347713,1.57240870895003,1.57276072496166,1.57310197254882,1.57343212274828,1.57375084659685,1.57405781513131,1.57435269938846,1.57463517040508,1.57490489921798,1.57516155686393,1.57540481437973,1.57563434280218,1.57584981316806,1.57605089651416,1.57623726387728,1.5764085862942,1.57656453480173,1.57670478043664,1.57682899423573,1.57693684723579,1.57702801047362,1.577102154986,1.57715895180973,1.57719807198159,1.57721918653838,1.57722196651688,1.5772060829539,1.57717120688622,1.57711700935063,1.57704316138393,1.57694933402289,1.57683519830433,1.57670042526502,1.57654468594176,1.57636765137134,1.57616899259055,1.57594838063618,1.57570548654503,1.57543998135387,1.57515153609952,1.57483982181875,1.57450450954836,1.57414527032513,1.57376177518587,1.57335369516736,1.57292070130639,1.57246246463976,1.57197865620425,1.57146894703665,1.57093300817377,1.57037051065238,1.56978112550928,1.56916452378126,1.56852037650512,1.56784835471763,1.56714812945561,1.56641937175582,1.56566175265508,1.56487494319016,1.56405861439786,1.56321243731498,1.56233608297829,1.5614292224246,1.56049152669069,1.55952266681335,1.55852231382939,1.55749013877558,1.55642581268872,1.5553290066056,1.55419939156301,1.55303663859774,1.55184041874659,1.55061040304634,1.54934626253378,1.54804766824572,1.54671429121893,1.54534580249021,1.54394187309635,1.54250217407415,1.54102637646039,1.53951415129186,1.53796516960536,1.53637910243767,1.5347556208256,1.53309439580592,1.53139509841543,1.52965739969092,1.52788097066919,1.52606548238702,1.5242106058812,1.52231601218854,1.5203813723458,1.5184063573898,1.51639063835732,1.51433388628515,1.51223577221008,1.5100959671689,1.50791414219841,1.505689971847,1.50342355556722,1.50111581803867,1.49876777875429,1.49638045720702,1.49395487288979,1.49149204529553,1.48899299391718,1.48645873824767,1.48389029777994,1.48128869200692,1.47865494042155,1.47599006251676,1.47329507778548,1.47057100572064,1.46781886581519,1.46503967756206,1.46223446045418,1.45940423398448,1.4565500176459,1.45367283093138,1.45077369333384,1.44785362434622,1.44491364346147,1.4419547701725,1.43897802397225,1.43598442435367,1.43297499080968,1.42995074283321,1.42691269991721,1.4238618815546,1.42079930723833,1.41772599646132,1.4146429687165,1.41155124349682,1.40845184029521,1.4053457786046,1.40223407791793,1.39911775772812,1.39599783752812,1.39287533681086,1.38975127506927,1.38662667179628,1.38350254648484,1.38037991862788,1.37725980771832,1.37414323324911,1.37103121471317,1.36792477160345,1.36482492341288,1.36173268963438,1.3586490897609,1.35557514328537,1.35251186970073,1.3494602884999,1.34642141917582,1.34339628122143,1.34038589412966,1.33739127739345,1.33441345050573,1.33145343295942,1.32851224424748,1.32559090386283,1.3226904312984,1.31981184604714,1.31695616760197,1.31412441545583,1.31131760910165,1.30853676803237,1.30578291174092,1.30305705972024,1.30036023146325,1.29769344646291,1.29505772421213,1.29245408420385,1.28988354593101,1.28734712888654,1.28484585256338,1.28238073645445,1.27995280005271,1.27756306285106,1.27521254434247,1.27290226401985,1.27063324137614,1.26840649590427,1.26622304709719,1.26408391444782,1.26199011744909,1.25994267559395,1.25794260837533,1.25599093528616,1.25408867581937,1.2522368494679,1.25043647572469,1.24868857408266,1.24699416403475,1.2453542650739,1.24376989669305,1.24224207838511,1.24077182964304,1.23936016995976,1.23800811882821,1.23671669574132,1.23548692019202,1.23431981167326,1.23321638967796,1.23217767369905,1.23120468322949,1.23029843776218,1.22945995679009,1.22869025980612,1.22799036630323,1.22736129577434,1.22680406771239,1.22631970161031,1.22590921696104,1.22557363325751,1.22531396999266,1.22513124665941,1.22502648275071,1.22500068774247,1.22505404115809,1.22518528366208,1.22539301243904,1.22567582467352,1.22603231755011,1.22646108825338,1.22696073396791,1.22752985187826,1.22816703916902,1.22887089302475,1.22964001063004,1.23047298916946,1.23136842582757,1.23232491778896,1.2333410622382,1.23441545635987,1.23554669733853,1.23673338235877,1.23797410860516,1.23926747326227,1.24061207351467,1.24200650654695,1.24344936954367,1.24493925968941,1.24647477416875,1.24805451016626,1.24967706486651,1.25134103545408,1.25304501911354,1.25478761302947,1.25656741438644,1.25838302036903,1.26023302816181,1.26211603494935,1.26403063791623,1.26597543424703,1.26794902112631,1.26994999573866,1.27197695526864,1.27402849690084,1.27610321781982,1.27819971521016,1.28031658625644,1.28245242814323,1.2846058380551,1.28677541317663,1.2889597506924,1.29115744778697,1.29336710164492,1.29558730945083,1.29781666838927,1.30005377564482,1.30229722840204,1.30454562384552,1.30679755915983,1.30905163152955,1.31130643813924,1.31356057617348,1.31581264281685,1.31806123525392,1.32030495066926,1.32254238624746,1.32477213917308,1.3269928066307,1.32920298580489,1.33140127388023,1.33358626804129,1.33575656547265,1.33791076335889,1.34004745888456,1.34216524923426,1.34426273159255,1.34633850314401,1.34839116107322,1.35041930256474,1.35242152480316,1.35439642497304,1.35634260025896,1.3582586478455,1.36014316491723,1.36199474865873,1.36381199625456,1.36559350488931,1.36733787174755,1.36904369401385,1.37070956887279,1.37233409350894,1.37391586510687,1.37545348085117,1.3769455379264,1.37839063351714,1.37978736480796,1.38113432898344,1.38243012322816,1.38367334472668,1.38486259066359,1.38599645822345,1.38707354459084,1.38809244695034,1.38905176248652,1.38995008838395,1.39078602182721,1.39155816000087,1.39226510008951,1.39290543927771,1.39347777475003,1.39398070369105,1.39441282328535,1.39477273071749,1.39505902317206,1.39527029783363,1.39540515188678,1.39546218251607,1.39543998690608,1.39533716224139,1.39515230570657,1.3948840144862,1.39453088576485,1.39409151672709,1.39356452345776,1.39294965605757,1.39224842235178,1.39146248136778,1.39059349213297,1.38964311367473,1.38861300502046,1.38750482519754,1.38632023323336,1.38506088815531,1.38372844899078,1.38232457476716,1.38085092451185,1.37930915725222,1.37770093201568,1.3760279078296,1.37429174372138,1.37249409871841,1.37063663184808,1.36872100213778,1.36674886861489,1.36472189030681,1.36264172624093,1.36051003544463,1.35832847694531,1.35609870977035,1.35382239294715,1.35150118550309,1.34913674646557,1.34673073486197,1.34428480971968,1.34180063006609,1.3392798549286,1.33672414333458,1.33413515431144,1.33151454688656,1.32886398008733,1.32618511294114,1.32347960447538,1.32074911371743,1.3179952996947,1.31521982143457,1.31242433796442,1.30961050831165,1.30677999150364,1.30393444656779,1.30107553253149,1.29820490842213,1.29532423326709,1.29243516609376,1.28953936592954,1.28663849180181,1.28373420273796,1.28082815776539,1.27792201591148,1.27501743620363,1.27211607766921,1.26921959933563,1.26632966023026,1.26344791938051,1.26057603581376,1.25771566855739,1.25486847663881,1.25203611908539,1.24922025492453,1.24642254318362,1.24364464289005,1.24088821307121,1.23815491275448,1.23544640096726,1.23276433673693,1.23011037909089,1.22748618705652,1.22489341966122,1.22233373593237,1.21980879489736,1.21732025558359,1.21486977701844,1.21245901822931,1.21008963824357,1.20776329608863,1.20548165079186,1.20324636138067,1.20105908688244,1.19892148632456,1.19683521873441,1.1948019431394,1.1928233185669,1.19090100404432,1.18903665859903,1.18723194125842,1.1854885110499,1.18380802700084,1.18219214813863,1.18064253349067,1.17916084208435,1.17774873294705,1.17640786510616,1.17513989758908,1.17394648942319,1.17282929963589,1.17178998725455,1.17083021130658,1.16995163081936,1.16915590482028,1.16844469233673,1.16781965239611,1.16728244402579,1.16683472625317,1.16647815810564,1.16621439861059,1.1660451067954,1.16597194168748,1.1659965623142,1.16612062770296,1.16634579688114,1.16667372887615,1.16710608271535,1.16764451742615,1.16829069203594,1.16904623592631,1.16991143563448,1.17088471440498,1.17196435823334,1.17314865311507,1.17443588504571,1.17582434002076,1.17731230403575,1.17889806308621,1.18057990316764,1.18235611027558,1.18422497040555,1.18618476955307,1.18823379371365,1.19037032888282,1.1925926610561,1.19489907622901,1.19728786039708,1.19975729955582,1.20230567970075,1.2049312868274,1.20763240693129,1.21040732600794,1.21325433005287,1.2161717050616,1.21915773702965,1.22221071195255,1.22532891582581,1.22851063464496,1.23175415440551,1.235057761103,1.23841974073293,1.24183837929084,1.24531196277223,1.24883877717265,1.25241710848759,1.2560452427126,1.25972146584318,1.26344406387486,1.26721132280315,1.27102152862359,1.2748729673317,1.27876392492298,1.28269268739297,1.28665754073719,1.29065677095115,1.29468866403038,1.2987515059704,1.30284358276674,1.3069631804149,1.31110858491042,1.31527808224881,1.3194699584256,1.32368249943631,1.32791399127645,1.33216271994155,1.33642697142714,1.34070503172872,1.34499518684183,1.34929572276199,1.3536049254847,1.35792108100551,1.36224247531992,1.36656739442347,1.37089412431166,1.37522095098003,1.37954616042409,1.38386803863936,1.38818487162137,1.39249494536563,1.39679654586768,1.40108795912302,1.40536747112718,1.40963336787569,1.41388393536405,1.4181174595878,1.42233222654246,1.42652652222354,1.43069863262657,1.43484684374707,1.43896944158056,1.44306471212256,1.4471309413686,1.45116641531418,1.45516941995485,1.45913824128611,1.46307116530348,1.4669664780025,1.47082246537867,1.47463741342753,1.47840960814459,1.48213733552537,1.4858188815654,1.4894525322602,1.49303657360528,1.49656929159617,1.50004897222839,1.50347390149746,1.5068423653989,1.51015264992824,1.51340304108099,1.51659182485268,1.51971728723882,1.52277771423494,1.52577139183657,1.52869660603921,1.5315516428384,1.53433478822965,1.53704432820848,1.53967854877042,1.54223573591099,1.5447141756257,1.54711215391009,1.54942795675966,1.55165987016995,1.55380618013647,1.55586517265474,1.55783513372029,1.55971434932864,1.56150110547531,1.56319372669011,1.56479189791793,1.56629699560542,1.56771050193735,1.5690338990985,1.57026866927366,1.5714162946476,1.57247825740511,1.57345603973095,1.57435112380992,1.57516499182679,1.57589912596634,1.57655500841335,1.5771341213526,1.57763794696888,1.57806796744695,1.5784256649716,1.57871252172761,1.57893001989976,1.57907964167283,1.5791628692316,1.57918118476085,1.57913607044535,1.57902900846989,1.57886148101925,1.5786349702782,1.57835095843153,1.57801092766402,1.57761636016044,1.57716873810557,1.5766695436842,1.57612025908111,1.57552236648107,1.57487734806886,1.57418668602927,1.57345186254707,1.57267435980704,1.57185565999396,1.57099724529262,1.57010059788779,1.56916719996425,1.56819853370677,1.56719608130016,1.56616132492917,1.56509574677859,1.5640008290332,1.56287805387778,1.5617289034971,1.56055486007596,1.55935740579912,1.55813802285138,1.5568981934175,1.55563939968226,1.55436312383046,1.55307084804685,1.55176405451624,1.55044422542339,1.54911284295309,1.54777138929011,1.54642134661924,1.54506419712525,1.54370142299292,1.54233450640704,1.54096492955238,1.53959417461372,1.53822372377585,1.53685505922354,1.53548966314157,1.53412901771472,1.53277460512777,1.5314279075655,1.5300904072127,1.52876358625413,1.52744892687459,1.52614791125884,1.52486202159167,1.52359274005786,1.52234154884219,1.52110993012944,1.51989936610438,1.5187113389518,1.51754733085648,1.5164088240032,1.51529730057673,1.51421424276186,1.51316113274336,1.51213945270602,1.51115068483461,1.51019631131392,1.50927781432872,1.50839667606379,1.50755437870392,1.50675240443388,1.50599223543845,1.50527535390242,1.50460324201056,1.50397738194765,1.50339925589847,1.5028703460478,1.50239213458043,1.50196610368112,1.50159373553466,1.50127651232583,1.50101591623942,1.50081342946019,1.50067053417293,1.50058871256241,1.50056944681343,1.50061421911075,1.50072451163916,1.50090180658344,1.50114758612836,1.50146333245871,1.50185052775926,1.5023106542148,1.50284519401011,1.50345562932996,1.50414344235913,1.50491011528241,1.50575713028457,1.50668592833115,1.5076967874847,1.50878868930613,1.50996054731827,1.51121127504396,1.51253978600601,1.51394499372726,1.51542581173055,1.5169811535387,1.51860993267454,1.5203110626609,1.52208345702062,1.52392602927652,1.52583769295144,1.5278173615682,1.52986394864963,1.53197636771857,1.53415353229784,1.53639435591028,1.53869775207872,1.54106263432598,1.5434879161749,1.54597251114831,1.54851533276903,1.55111529455991,1.55377131004376,1.55648229274342,1.55924715618172,1.56206481388149,1.56493417936556,1.56785416615676,1.57082368777792,1.57384165775187,1.57690698960144,1.58001859684947,1.58317539301878,1.58637629163219,1.58962020621256,1.59290605028269,1.59623273736543,1.59959918098361,1.60300429466005,1.60644699191758,1.60992618627904,1.61344079126725,1.61698972040505,1.62057188721527,1.62418620522073,1.62783158794427,1.63150694890872,1.63521120163691,1.63894325965166,1.64270203647581,1.64648644563219,1.65029540064364,1.65412781503297,1.65798260232302,1.66185867603662,1.6657549496966,1.66967033682579,1.67360375094703,1.67755410558314,1.68152031425694,1.68550129049129,1.68949594780899,1.69350319973289,1.69752195978581,1.70155114149059,1.70558965837005,1.70963642394703,1.71369035174435,1.71775035528485,1.72181534809135,1.72588424368669,1.7299559555937,1.7340293973352,1.73810348243403,1.74217712441302,1.746249236795,1.7503187331028,1.75438452685924,1.75844553158717,1.76250066080941,1.76654882804878,1.77058894682813,1.77461993067028,1.77864069309805,1.78265014763429,1.78664720780183,1.79063078712348,1.79459979912209,1.79855315732048,1.80248977524149,1.80640856640793,1.81030844434266,1.81418832256849,1.81804711460825,1.82188373398478,1.8256970942209,1.82948610883945,1.83324969136326,1.83698675531515,1.84069621421796,1.84437698159452,1.84802797096766,1.85164809586021,1.85523626979499,1.85879140629485,1.8623124188826,1.86579822108108,1.86924772641313,1.87265984840156,1.87603350056922,1.87936759643892,1.88266104953351,1.88591277337581,1.88912168148866,1.89228668739488,1.8954067046173,1.89848064667875,1.90150743200614,1.90448609181995,1.90741577013427,1.91029561586726,1.91312477793705,1.91590240526182,1.9186276467597,1.92129965134886,1.92391756794745,1.92648054547362,1.92898773284552,1.9314382789813,1.93383133279912,1.93616604321714,1.9384415591535,1.94065702952636,1.94281160325386,1.94490442925417,1.94693465644544,1.94890143374582,1.95080391007346,1.95264123434651,1.95441255548314,1.95611702240148,1.9577537840197,1.95932198925595,1.96082078702837,1.96224932625513,1.96360675585438,1.96489222474427,1.96610488184294,1.96724387606857,1.96830835633929,1.96929747157326,1.97021037068864,1.97104620260357,1.97180411623622,1.97248326050473,1.97308278432725,1.97360183662194,1.97403956630696,1.97439512230045,1.97466765352057,1.97485630888547,1.9749602373133,1.97497858772222,1.97491050903038,1.97475515015594,1.97451166001704,1.97417918753183,1.97375688161849,1.97324389119514,1.97263936517995,1.97194245249108,1.97115230204667,1.97026806276487,1.96928888356385,1.96821391336174,1.96704230107672,1.96577319562692,1.9644057459305,1.96293910090562,1.96137240947043,1.95970482054308,1.95793548304172,1.95606354588451,1.95408815798959,1.95200846827513,1.94982362565928,1.94753277906018,1.945135077396,1.94262966958488,1.94001570454498,1.93729233119445,1.93445869845144,1.93151395523411,1.92845725046061,1.92528773304909,1.9220045519177,1.91860685598461,1.91509379416795,1.9114645153859,1.90771816855658,1.90385390259817,1.89987086642881,1.89576820896666,1.89154507912987,1.88720062583659,1.88273399800497,1.87814434455318,1.87343081439935,1.86859255646165,1.86362871965823,1.85853845290723,1.85332090512682,1.84797522523515,1.84250056215036,1.83689606479062,1.83116088207407,1.82529416291887,1.81929505624317,1.81316271096513,1.80689627600289,1.80049490027461,1.79395773269845,1.78728392219255,1.78047261767507,1.77352296806416,1.76643412227798,1.75920522923467,1.7518354378524,1.74432389704931,1.73666975574356,1.72887216285329,1.72093026729667,1.71284321799185,1.70461016385697,1.6962302538102,1.68770263676968,1.67902646165357,1.6702010395897,1.66122877269741,1.65211483557476,1.64286450109068,1.63348304211408,1.62397573151391,1.61434784215907,1.60460464691851,1.59475141866113,1.58479343025587,1.57473595457166,1.56458426447741,1.55434363284205,1.54401933253452,1.53361663642372,1.5231408173786,1.51259714826807,1.50199090196106,1.49132735132649,1.48061176923329,1.46984942855039,1.45904560214671,1.44820556289117,1.43733458365271,1.42643793730024,1.41552089670269,1.40458873472899,1.39364672424806,1.38270013812883,1.37175424924022,1.36081433045115,1.34988565463057,1.33897349464737,1.3280831233705,1.31721981366888,1.30638883841143,1.29559547046709,1.28484498270476,1.27414264799339,1.26349373920189,1.25290352919919,1.24237729085421,1.23192029703589,1.22153782061314,1.21123513445489,1.20101751143007,1.1908902244076,1.18085854625641,1.17092774984542,1.16110310804355,1.15138989371974,1.14179337974291,1.13231883898197,1.12297154430587,1.11375676858352,1.10467978468385,1.09574586547578,1.08696028382824,1.07832831261016,1.06985522469045,1.06154629293805,1.05340679022188,1.04544198941087,1.03765716337393,1.03005758498,1.02264852709801,1.01543526259687,1.00842306434551,1.00161720521285,0.995022958067833,0.98864559577937,0.982490391216389,0.976562617247815,0.970867546742576,0.965410452569594,0.960196607597795,0.955231284696106,0.95051975673345,0.946067296578753,0.941879177100941,0.937960671168939,0.934317051651672,0.930953591418065,0.927875563337043,0.925088240277532,0.922596895108457,0.920406800698743,0.918523229917315,0.9169514556331,0.915696750715021,0.914764388032004,0.914159640452975,0.913887780846858,0.913954082082579,0.914363817029064,0.915122258555237,0.916234679530023,0.917706352822348,0.919542551301138,0.921748547835316,0.924329615293809,0.927291026545543,0.930638054459441,0.934375971904429,0.938510051749434,0.943045566863379,0.94798779011519,0.953341994373793,0.959113452508112,0.965307437387072,0.971929221879601,0.978984078854621,0.986477281181058,0.99441410172784,1.00279981336389,1.01163968895813,1.02093900137949,1.03070302349689,1.04093702817927,1.05164628829554,1.06283560782458,1.07450228987155,1.08663760485424,1.0992326523121,1.11227853178463,1.12576634281129,1.13968718493156,1.15403215768492,1.16879236061084,1.18395889324879,1.19952285513826,1.21547534581871,1.23180746482963,1.24851031171049,1.26557498600076,1.28299258723992,1.30075421496744,1.31885096872281,1.33727394804549,1.35601425247497,1.37506298155071,1.39441123481219,1.4140501117989,1.43397071205029,1.45416413510586,1.47462148050507,1.4953338477874,1.51629233649233,1.53748804615933,1.55891207632788,1.58055552653745,1.60240949632752,1.62446508523756,1.64671339280705,1.66914551857547,1.69175256208228,1.71452562286698,1.73745580046902,1.76053419442789,1.78375190428306,1.80710002957401,1.83056966984021,1.85415192462115,1.87783789345629,1.9016186758851,1.92548537144708,1.94942907968168,1.97344090012839,1.99751193232668,2.02163327581603,2.04579603013592,2.06999129482581,2.09421016942519,2.11844375347353,2.14268314651029,2.16691944807498,2.19114375770705,2.21534717494598,2.23952079933124,2.26365573040233,2.28774306769869,2.31177391075983,2.3357393591252,2.35963051233429,2.38343846992656,2.40715433144151,2.4307691964186,2.4542741643973,2.4776603349171,2.50091880751746,2.52404068173786,2.54701705711779,2.56983903319671,2.5924977095141,2.61498418560944,2.6372895610222,2.65940493529185,2.68132140795789,2.70303007855976,2.72452204663696,2.74578841172896,2.76682027337523,2.78760873111526,2.8081448844885,2.82841983303445,2.84842467629258,2.86815051380236,2.88758844510326,2.90672956973477,2.92556498723636,2.9440857971475,2.96228309900767,2.98014799235635,2.997671576733,3.01484495167712,3.03165921672816,3.04810547142562,3.06417481530895,3.07985834791765,3.09514716879117,3.11003237746901,3.12450507349064,3.13855635639552,3.15217732572314,3.16535908101297,3.17809272180449,3.19036934763717,3.20218005805049,3.21351595258392,3.22436813077694,3.23472769216903,3.24458573629965,3.2539333627083,3.26276167093443,3.27106176051753,3.27882473099707,3.28604168191253,3.29270371280339,3.29880192320911,3.30432741266918,3.30927197003781,3.31363674230624,3.31742962072117,3.32065864542131,3.32333185654536,3.325457294232,3.32704299861993,3.32809700984786,3.32862736805449,3.3286421133785,3.32814928595859,3.32715692593347,3.32567307344184,3.32370576862238,3.32126305161379,3.31835296255478,3.31498354158404,3.31116282884027,3.30689886446217,3.30219968858843,3.29707334135775,3.29152786290883,3.28557129338036,3.27921167291105,3.27245704163958,3.26531543970467,3.257794907245,3.24990348439927,3.24164921130619,3.23304012810444,3.22408427493273,3.21478969192975,3.2051644192342,3.19521649698478,3.18495396532018,3.1743848643791,3.16351723430025,3.15235911522231,3.14091854728399,3.12920357062398,3.11722222538098,3.10498255169369,3.0924925897008,3.07976037954102,3.06679396135303,3.05360137527554,3.04019066144725,3.02656986000685,3.01274701109303,2.99873015484451,2.98452733139997,2.97014658089811,2.95559594347763,2.94088345927722,2.9260171684356,2.91100511109144,2.89585532738345,2.88057585745033,2.86517474143077,2.84966001946347,2.83403973168713,2.81832191824045,2.80251461926212,2.78662587489084,2.77066372526532,2.75463621052424,2.7385513708063,2.7224172462502,2.70624187699464,2.69003330317832,2.67379956493993,2.65754870241817,2.64128875575174,2.62502776507933,2.60877377053965,2.59253481227139,2.57631893041325,2.56013416510392,2.54398855648211,2.52789014468651,2.51184696985581,2.49586707212872,2.47995849164393,2.46412926854015,2.44838744295605,2.43274105503036,2.41719814490176,2.40176675270895,2.38645491859062,2.37127068268548,2.35622208513223,2.34131716606955,2.32656396563615,2.31197052397073,2.29754488121197,2.28329507749859,2.26922915296928,2.25535514776273,2.24168110201764,2.22821505587271,2.21496504946663,2.20193912293811,2.18914531642585,2.17659167006853,2.16428622400486,2.15223701837354,2.14045209331325,2.12893948896271,2.1177072454606,2.10676340294562,2.09611600155648,2.08577308143187,2.07574268271048,2.06603284553101,2.05665161003217,2.04760701635265,2.03890710463114,2.03055991500635,2.02257348761696,2.01495586260169,2.00771449026515,2.00084996409095,1.99435845380717,1.98823605541265,1.98247886490622,1.9770829782867,1.97204449155294,1.96735950070376,1.96302410173799,1.95903439065446,1.95538646345202,1.95207641612948,1.94910034468568,1.94645434511946,1.94413451342963,1.94213694561504,1.94045773767452,1.9390929856069,1.938038785411,1.93729123308566,1.93684642462972,1.936700456042,1.93684942332134,1.93728942246656,1.9380165494765,1.93902690034999,1.94031657108587,1.94188165768296,1.94371825614009,1.94582246245609,1.94819037262981,1.95081808266006,1.95370168854569,1.95683728628552,1.96022097187838,1.96384884132311,1.96771699061853,1.97182151576349,1.9761585127568,1.98072407759731,1.98551430628383,1.99052529481522,1.99575313919029,2.00119393540788,2.00684377946682,2.01269876736593,2.01875499510406,2.02500855868004,2.03145555409269,2.03809207734085,2.04491422442335,2.05191809133902,2.05909977408668,2.06645536866519,2.07398097107335,2.08167267731002,2.08952658337402,2.09753878526417,2.10570537897931,2.11402246051828,2.1224861258799,2.13109247106301,2.13983759206643,2.148717584889,2.15772854552956,2.16686656998692,2.17612775425994,2.18550819434742,2.19500398624821,2.20461122596114,2.21432600948504,2.22414443281874,2.23406259196108,2.24407658291087,2.25418250166697,2.26437644422819,2.27465450659337,2.28501278476134,2.29544737473094,2.30595437250099,2.31652987407032,2.32716997543777,2.33787077260217,2.34862836156235,2.35943883831714,2.37029829886537,2.38120283920588,2.3921485553375,2.40313154325905,2.41414789896937,2.42519371846729,2.43626509775165,2.44735813282127,2.45846891967498,2.46959355431162,2.48072813273003,2.49186875092901,2.50301150490743,2.51415249066409,2.52528780419784,2.53641354150751,2.54752579859192,2.55862067144992,2.56969425608032,2.58074264848197,2.59176194465369,2.60274824059432,2.61369763230268,2.62460621577762,2.63547008701795,2.64628534202251,2.65704807679014,2.66775438731967,2.67840036960992,2.68898211965973,2.69949573346793,2.70993730703334,2.72030293635482,2.73058871743118,2.74079074626125,2.75090537033254,2.76093145913449,2.77086933688005,2.78071934533979,2.7904818262843,2.80015712148414,2.8097455727099,2.81924752173215,2.82866331032146,2.83799328024842,2.8472377732836,2.85639713119757,2.86547169576092,2.87446180874422,2.88336781191804,2.89219004705297,2.90092885591957,2.90958458028843,2.91815756193013,2.92664814261523,2.93505666411431,2.94338346819797,2.95162889663675,2.95979329120125,2.96787699366204,2.9758803457897,2.98380368935481,2.99164736612793,2.99941171787965,3.00709708638055,3.01470381340119,3.02223224071216,3.02968271008404,3.0370555632874,3.0443511420928,3.05156978827085,3.0587118435921,3.06577764982714,3.07276754874654,3.07968188212088,3.08652099172073,3.09328521931667,3.09997490667929,3.10659039557914,3.11313202778682,3.1196001450729,3.12599508920795,3.13231720196255,3.13856682510728,3.14474430041271,3.15084996964942,3.15688417458799,3.16284725699899,3.168739558653,3.1745614213206,3.18031318677236,3.18599519677886,3.19160779311067,3.19715131753838,3.20262611183255,3.20803251776377,3.21337087710261,3.21864153161965,3.22384482308546,3.22898109327063,3.23405068394572,3.23905393688132,3.24399119384799,3.24886279661633,3.2536690869569,3.25841040664027,3.26308709743704,3.26769950111776,3.27224795945303,3.27673281421341,3.28115440716949,3.28551308009183,3.28980917475102,3.29404303291763,3.29821499636224,3.30232540685543,3.30637460616777,3.31036293606983,3.3142907383322,3.31815835472545,3.32196612702016,3.3257143969869,3.32940350639625,3.33303379701879,3.33660561062509,3.34011928898574,3.3435751738713,3.34697360705235,3.35031493029947,3.35359948538324,3.35682761407423,3.35999965814302,3.36311595936019,3.3661768594963,3.36918270032195,3.3721338236077,3.37503057112413,3.37787328464182,3.38066230593134,3.38339797676328,3.3860806389082,3.38871063413669,3.39128830421932,3.39381399092666,3.3962880360293,3.39871078129781,3.40108256850276,3.40340373941474,3.40567463580432,3.40789559944207,3.41006697209857,3.41218909554441,3.41426231155015,3.41628696188637,3.41826338832365,3.420191908265,3.42207262702538,3.42390554071696,3.4256906445494,3.42742793373238,3.42911740347555,3.4307590489886,3.43235286548119,3.43389884816298,3.43539699224364,3.43684729293285,3.43824974544026,3.43960434497555,3.44091108674839,3.44216996596844,3.44338097784537,3.44454411758885,3.44565938040855,3.44672676151413,3.44774625611526,3.44871785942161,3.44964156664285,3.45051737298865,3.45134527366867,3.45212526389259,3.45285733887006,3.45354149381076,3.45417772392436,3.45476602442052,3.45530639050891,3.45579881739921,3.45624330030107,3.45663983442416,3.45698841497816,3.45728903717273,3.45754169621754,3.45774638732225,3.45790310569655,3.45801184655008,3.45807260509252,3.45808537653355,3.45805015608282,3.45796693895,3.45783572034477,3.45765649547678,3.45742925955572,3.45715400779124,3.45683073539301,3.45645943757071,3.456040109534,3.45557274649254,3.45505734365601,3.45449389623408,3.4538823994364,3.45322284847266,3.45251523855251,3.45175956488563,3.45095582268168,3.45010400715033,3.44920411350125,3.44825613694411,3.44726007268857,3.44621591594431,3.44512366192099,3.44398330582827,3.44279484287583,3.44155826827334,3.44027357723046,3.43894076495685,3.4375598266622,3.43613075755616,3.43465355284841,3.43312820774861,3.43155471746643,3.42993307721153,3.42826328219359,3.42654532762228,3.42477920870726,3.42296492065819,3.42110245868476,3.41919181799662,3.41723299380344,3.41522598131489,3.41317077574064,3.41106737229036,3.40891576617371,3.40671595260037,3.40446792678,3.40217168392226,3.39982721923683,3.39743452793338,3.39499360522157,3.39250444631107,3.38996704641154,3.38738140073266,3.3847475044841,3.38206535287552,3.37933494111659,3.37655626441697,3.37372931798634,3.37085409703437,3.36793059677071,3.36495881240505,3.36193873914704,3.35887037220636,3.35575370679267,3.35258873811564,3.34937546138494,3.34611387181024,3.3428039646012,3.3394457349675,3.33603917811879,3.33258428926476,3.32908106361506,3.32552949637936,3.32192958276734,3.31828131798865,3.31458469725298,3.31083971576998,3.30704636874932,3.30320473829538,3.29931556618507,3.29537989683821,3.29139877625818,3.28737325044839,3.28330436541222,3.27919316715308,3.27504070167435,3.27084801497944,3.26661615307173,3.26234616195462,3.25803908763152,3.2536959761058,3.24931787338087,3.24490582546013,3.24046087834696,3.23598407804477,3.23147647055694,3.22693910188688,3.22237301803798,3.21777926501362,3.21315888881722,3.20851293545216,3.20384245092184,3.19914848122965,3.19443207237899,3.18969427037326,3.18493612121584,3.18015867091014,3.17536296545954,3.17055005086745,3.16572097313725,3.16087677827236,3.15601851227615,3.15114722115202,3.14626395090337,3.1413697475336,3.1364656570461,3.13155272544426,3.12663199873148,3.12170452291115,3.11677134398668,3.11183350796144,3.10689206083885,3.1019480486223,3.09700251731517,3.09205651292087,3.08711108144278,3.08216726888431,3.07722612124885,3.0722886845398,3.06735600476055,3.06242912791449,3.05750910000502,3.05259696703554,3.04769377500943,3.04280056993011,3.03791839780095,3.03304830462536,3.02819133640673,3.02334853914845,3.01852095885393,3.01370964152655,3.00891563316971,3.00413997978681,2.99938372738123,2.99464792195639,2.98993360951566,2.98524183606246,2.98057364760016,2.97593009013217,2.97131220966188,2.96672105219268,2.96215766372798,2.95762309027117,2.95311837782563,2.94864457239477,2.94420271998199,2.93979386659067,2.93541905822421,2.93107934088601,2.92677576057946,2.92250936330796,2.9182811950749,2.91409230188367,2.90994372973768,2.90583652464032,2.90177173259498,2.89775039960505,2.89377357167394,2.88984229480504,2.88595761500173,2.88212057826743,2.87833223060552,2.87459361801939,2.87090578651245,2.86726978208809,2.8636866507497,2.86015743850067,2.85668319134441,2.85326495528431,2.84990377632376,2.84660070046616,2.8433567737149,2.84017304207338,2.837050551545,2.83399034813314,2.83099347784121,2.82806098667259,2.82519392063069,2.8223933257189,2.8196602479406,2.81699573329921,2.81440082779812,2.81187657744071,2.80942402823038,2.80704422617054,2.80473821726457,2.80250704751586,2.80035176292783,2.79827324496517,2.7962712812395,2.79434521313354,2.79249438071368,2.79071812404634,2.78901578319792,2.78738669823482,2.78583020922346,2.78434565623023,2.78293237932154,2.78158971856381,2.78031701402343,2.7791136057668,2.77797883386035,2.77691203837047,2.77591255936357,2.77497973690605,2.77411291106432,2.77331142190478,2.77257460949385,2.77190181389792,2.77129237518341,2.77074563341672,2.77026092866425,2.76983760099241,2.76947499046761,2.76917243715625,2.76892928112473,2.76874486243948,2.76861852116688,2.76854959737334,2.76853743112528,2.7685813624891,2.76868073153119,2.76883487831798,2.76904314291586,2.76930486539124,2.76961938581053,2.76998604424013,2.77040418074645,2.77087313539589,2.77139224825486,2.77196085938976,2.77257830886701,2.77324393675301,2.77395708311415,2.77471708801686,2.77552329152753,2.77637503371257,2.77727165463838,2.77821249437138,2.77919689297797,2.78022419052454,2.78129372707752,2.78240484270331,2.7835568774683,2.78474917143891,2.78598106468155,2.78725189726261,2.7885610092485,2.78990774070564,2.79129143170042,2.79271142229926,2.79416705256855,2.7956576625747,2.79718259238413,2.79874118206323,2.80033277167841,2.80195670129607,2.80361231098263,2.80529894080449,2.80701593082805,2.80876262111972,2.81053835174591,2.81234246277302,2.81417429426746,2.81603318629563,2.81791847892393,2.81982951221879,2.82176562624659,2.82372616107375,2.82571045676668,2.82771785339177,2.82974769101543,2.83179930970408,2.83387204952411,2.83596525054193,2.83807825282395,2.84021039643657,2.8423610214462,2.84452946791925,2.84671507592212,2.84891718552121,2.85113513678293,2.8533682697737,2.8556159245599,2.85787744120796,2.86015215978427,2.86243942035525,2.86473856298729,2.8670489277468,2.86936985470019,2.87170068391387,2.87404075545424,2.8763894093877,2.87874598578066,2.88110982469954,2.88348026621073,2.88585665038063,2.88823831727566,2.89062460696223,2.89301485950673,2.89540841497557,2.89780461343516,2.90020279495191,2.90260229959221,2.90500246742249,2.90740263850913,2.90980215291855,2.91220035071716,2.91459653981012,2.91698984029227,2.91937930427917,2.92176398379259,2.92414293085433,2.92651519748616,2.92887983570989,2.9312358975473,2.93358243502017,2.93591850015028,2.93824314495944,2.94055542146942,2.94285438170202,2.94513907767901,2.94740856142219,2.94966188495334,2.95189810029426,2.95411625946672,2.95631541449251,2.95849461739343,2.96065292019126,2.96278937490778,2.96490303356478,2.96699294818406,2.96905817078739,2.97109775339657,2.97311074803338,2.97509620671961,2.97705318147704,2.97898072432747,2.98087788729268,2.98274372239445,2.98457728165458,2.98637761709485,2.98814378073705,2.98987482460296,2.99156980071438,2.99322776109309,2.99484775776087,2.99642884273952,2.99797006805082,2.99947048571656,3.00092914775852,3.00234510619849,3.00371741305827,3.00504512035963,3.00632728012437,3.00756294437426,3.00875116513111,3.00989099441669,3.01098148425279,3.0120216866612,3.01301065366371,3.0139474372821,3.01483108953817,3.01566066245369,3.01643520805045,3.01715377835025,3.01781542537487,3.01841920114609,3.01896415768571,3.0194493470155,3.01987382115727,3.02023663213279,3.02053683196385,3.02077347267224,3.02094560627975,3.02105228480816,3.02109256027926,3.02106548471484,3.02097011013668,3.02080548856657,3.02057067202631,3.02026471253766,3.01988666212244,3.01943557280241,3.01891049659937,3.0183104855351,3.01763459163139,3.01688186691004,3.01605136339282,3.01514213310152,3.01415322805793,3.01308370028384,3.01193260180103,3.0106989846313,3.00938190079642,3.00798040231819,3.00649354121839,3.00492036951881,3.00325993924124,3.00151130240746,2.99967351103926,2.99774561715843,2.99572667278676,2.99361572994602,2.99141184065802,2.98911405694453,2.98672143082735,2.98423301432826,2.98164785946905,2.9789650182715,2.9761835427574,2.97330248494854,2.97032089686671,2.9672378305337,2.96405233797128,2.96076347120125,2.9573702822454,2.9538718231255,2.95026714586336,2.94655530248075,2.94273534499947,2.9388063254413,2.93476729582802,2.93061730818143,2.92635541452331,2.92198066687545,2.91749211725964,2.91288881769765,2.90817013692501,2.90333707198074,2.89839114173194,2.8933338652837,2.88816676174107,2.88289135020912,2.87750914979293,2.87202167959755,2.86643045872807,2.86073700628953,2.85494284138702,2.84904948312559,2.84305845061032,2.83697126294627,2.83078943923852,2.82451449859212,2.81814796011215,2.81169134290367,2.80514616607175,2.79851394872146,2.79179620995786,2.78499446888602,2.77811024461102,2.77114505623791,2.76410042287177,2.75697786361766,2.74977889758065,2.74250504386581,2.73515782157819,2.72773874982289,2.72024934770495,2.71269113432945,2.70506562880145,2.69737435022603,2.68961881770824,2.68180055035316,2.67392106726585,2.66598188755139,2.65798453031483,2.64993051466125,2.64182135969571,2.63365858452328,2.62544370824903,2.61717824997803,2.60886372881534,2.60050166386603,2.59209357423516,2.58364097902782,2.57514539734905,2.56660834830394,2.55803135099755,2.54941592453493,2.54076358802117,2.53207586056133,2.52335426126048,2.51460030922368,2.50581552355601,2.49700142336252,2.48815952774829,2.47929135581839,2.47039842667787,2.46148225943182,2.45254437318529,2.44358628704336,2.43460952011108,2.42561559149354,2.41660602029579,2.40758232562291,2.39854602657996,2.389498642272,2.38044169180411,2.37137669428135,2.3623051688088,2.35322863449151,2.34414861043456,2.33506661574301,2.32598416952193,2.31690279087639,2.30782399891145,2.29874931273219,2.28968025144367,2.28061833415095,2.27156507995911,2.26252200797321,2.25349063729832,2.24447248703951,2.23546907630184,2.22648192419038,2.21751254981021,2.20856247226638,2.19963321066396,2.19072628410803,2.18184321170364,2.17298551255587,2.16415470576978,2.15535231045045,2.14657984570293,2.1378388306323,2.12913078434362,2.12045722594197,2.1118196745324,2.10321964921999,2.0946586691098,2.0861382533069,2.07765992091636,2.06922519104324,2.06083558279262,2.05249261526956,2.04419780757913,2.03595267882638,2.02775874811641,2.01961753455426,2.01153055724501,2.00349933529372,1.99552538780547,1.98761023388531,1.97975539263832,1.97196238316957,1.96423272458412,1.95656793598704,1.94896953648339,1.94143904517825,1.93397798117668,1.92658786358374,1.91927021150452,1.91202654404407,1.90485838030745,1.89776723939975,1.89075464042602,1.88382210249134,1.87697114470077,1.87020328615937,1.86352004597222,1.85692294324438,1.85041349708092,1.84399322658692,1.83766365086742,1.83142628902751,1.82528266017225,1.8192342834067,1.81328267783594,1.80742936256504,1.80167585669905,1.79602367934305,1.7904743496021,1.78502938658128,1.77969030938564,1.77445863712027,1.76933588889021,1.76432358380055,1.75942324095634,1.75463637946267,1.74996451842458,1.74540917694716,1.74097187413547,1.73665412909457,1.73245746092953,1.72838338874543,1.72443343164733,1.72060910874029,1.71691193912938,1.71334344191967,1.70990513621623,1.70659854112413,1.70342517574843,1.7003865591942,1.69748421056651,1.69471964897042,1.692094393511,1.68960996329333,1.68726787742246,1.68506965500347,1.68301681514142,1.68111087694137,1.67935335950841,1.67774578194759,1.67628966336398,1.67498652286265,1.67383787954866,1.67284525252709,1.672010160903,1.67133412378146,1.67081866026754,1.6704652894663,1.67027553048281,1.67025090242214,1.67039292438936,1.67070311548953,1.67118299482771,1.67183408150899,1.67265789463842,1.67365595332108,1.67482977666203,1.67618088376633,1.67771079373906,1.67942102568528,1.68131309871006,1.68338853191847,1.68564884441557,1.68809555530644,1.69073018369613,1.69355424868973,1.69656926939228,1.69977676490887,1.70317825434456,1.70677525680442,1.7105692913935,1.71456187721689,1.71875453337966,1.72314877898685,1.72774613314355,1.73254811495482,1.73755624352573,1.74277203796135,1.74819701736673,1.75383270084696,1.7596806075071,1.76574225645221,1.77201916678737,1.77851285761764,1.78522484804808,1.79215665718377,1.79930980412978,1.80668580799116,1.81428618787299,1.82211246288034,1.83016615211826,1.83844877469184,1.84696184970614,1.85570689626622,1.86468543347715,1.873898980444,1.88334905627184,1.89303718006573,1.90296487093074,1.91313364797195,1.92354503029441,1.93420053700319,1.94510168720337,1.95625
}; // Array com valores de referência armazenados na memória FLASH. A memória RAM não tem espaço suficiente


// Simulação da planta
float y = 0;  // Saída simulada
float Ts = 0.1;
float Y_ref;
float tau0 = 1.4627;
float tau1 = 0.02402;
float Ke0  = 0.3624;
float Ke1  = -0.05229;
float tensao_atual;
float alpha = 0.1;
float tensaoFiltrada = 0;

float rho = 0;
float tau = 0;
float Ke = 0;
float erro = 0;
float I_erro[2] = {0, 0};
int index = 0; 

const int N = 2;
mtx_type x[N][1];
mtx_type Uc[1][1];

// Matrizes LPV
mtx_type Y0[N][N] = {
  {0.2219, -0.0784},
  {-0.0784, 0.0392}
};

mtx_type Y1[N][N] = {
  {0.0116e-5, 0.0730e-5},
  {0.0730e-5, 0.4627e-5}
};

mtx_type W0[1][N] = {1.5510, -0.1440};
mtx_type W1[1][N] = {0.0785, -0.0447};

mtx_type Prho[N][N];
mtx_type Wrho[1][N];
mtx_type Krho[1][N];

unsigned long previousMillis;
unsigned long currentMillis;

void setup() {
  Serial.begin(115200);
  pinMode(ledPin, OUTPUT);
  previousMillis = millis();
}

void loop() {
  currentMillis = millis();
  if (currentMillis - previousMillis >= Ts * 1000) {
    previousMillis = currentMillis;
    // Atualiza parâmetros da planta

    int valorLido = analogRead(solarPin);
    float tensao = (valorLido * 5.0) / 1023.0;
    tensaoFiltrada = alpha * tensao + (1 - alpha) * tensaoFiltrada;

    Y_ref = pgm_read_float_near(&ref[index]); //acessa memória flash
    tensao_atual = tensaoFiltrada;
    rho = 1*Y_ref;
    tau = tau0 + tau1 * rho;
    Ke  = Ke0 + Ke1 * rho;


    erro = rho - (tensao_atual);
    //erro = ref - y;

      if (Uc[0][0]<0.0 || Uc[0][0]>5){I_erro[1] = I_erro[0];} //anti windup clamping (para de acumular IE quando satura)
      else
      {I_erro[1] = I_erro[0] + Ts * erro;} 
    
    //I_erro[1] = I_erro[0] + Ts * erro;

    // Atualiza estado do controlador
    x[0][0] = erro;
    x[1][0] = I_erro[1];

    // LPV: Krho = (W0 + rho*W1)*(Y0 + rho*Y1)^-1
      mtx_type temp[N][N];
      mtx_type temp2[N][N];

      // Calculando Prho = inv(Y0 + rho*Y1);
      Matrix.Copy((mtx_type*)Y1, N, N, (mtx_type*)temp); //temp = Y1
      Matrix.Scale((mtx_type*)temp, N, N, rho); //temp = rho*temp
      Matrix.Add((mtx_type*)Y0, (mtx_type*)temp, N, N, (mtx_type*)temp2); // temp2 = Y0 + rho*Y1
      
      Matrix.Copy((mtx_type*)temp2, N, N, (mtx_type*)Prho); // Prho = temp2
      Matrix.Invert((mtx_type*)Prho, N); //Prho = inv(Prho)

      // Calculando Wrho = W0 + rho*W1
      mtx_type tempW[1][N];
    
      Matrix.Copy((mtx_type*)W1, 1, N, (mtx_type*)tempW); //tempW = W1
      Matrix.Scale((mtx_type*)tempW, 1, N, rho); // tempW = rho*tempW
      Matrix.Add((mtx_type*)W0, (mtx_type*)tempW, 1, N, (mtx_type*)Wrho); // Wrho = W0+tempW 

      // Calculando Krho = Wrho * Prho
      Matrix.Multiply((mtx_type*)Wrho, (mtx_type*)Prho, 1, N, N, (mtx_type*)Krho); // Wrho*Prho

    //if (Krho[0][1] < 0) Krho[0][1] = -Krho[0][1];
    Serial.print(Krho[0][0]);
    Serial.print(", ");
    Serial.print(Krho[0][1]);
    Serial.print(", ");
    //Krho[0][0] = 2;
    //Krho[0][1] = 2;

    // Uc = Krho * x
    Matrix.Multiply((mtx_type*)Krho, (mtx_type*)x, 1, N, N, (mtx_type*)Uc);

    // Simula planta: y(k+1) = y(k) - (Ts/tau)*y(k) + (Ts/tau)*Ke*u(k)
    y = y - (Ts / tau) * y + (Ts / tau) * Ke * Uc[0][0];
    
    // Saturação
    if (Uc[0][0] > 5) Uc[0][0] = 5;
    if (Uc[0][0] < 0) Uc[0][0] = 0;

    // Atualiza integral
    I_erro[0] = I_erro[1];

    // PWM de saída (opcional)
    analogWrite(ledPin, (int)(Uc[0][0] / 5.0 * 255));

    //erro = ref - y;

    // Print para análise
    Serial.print(Uc[0][0]);
    Serial.print(", ");
    Serial.print(ref - tensao_atual);
    Serial.print(", ");
    Serial.print(ref);
    Serial.print(", ");
    Serial.println(tensao_atual);
    //Serial.println(y);
    }
  }

